# Описание сервисов, бизнес событий и связей

##Auth
* Producing:
  * Асинхронные:
    * CUD-события:
      * создание юзера _(public_id, email, name, role)_
      * редактирование юзера _(public_id, email, name, role)_
      * удаление юзера _(public_id)_
    * BE-события:
      * смена роли юзера _(public_id, role)_
* Consuming:
  * Синхронные:
    * BE-события:
      * Запрос аутентификации
        * из **Tracker service**
        * из **Accounting service**
        * из **Analytics service**

  
## Tracker
* Producing:
  * Асинхронные:
    * CUD-события:
        * создание задачи _(public_id, name, description, status)_
        * редактирование задачи _(public_id, name, description)_
        * удаление задачи _(public_id)_
    * BE-события:
        * назначение задачи _(public_id, account_public_id)_
        * смена статуса задачи _(public_id, status)_
  * Синхронные:
    * BE-события:
      * Запрос аутентификации в **Auth service** _(account.email, account.password)_
* Consuming:
  * Асинхронные:
    * из **Auth service:**
      * CUD-события:
        * создание юзера
        * редактирование юзера
        * удаление юзера
      * BE-события:
        * смена роли юзера

## Accounting
* Producing:
  * Асинхронные:
    * BE-события:
      * Снижение баланса при назначении таски юзеру _(account_public_id, task.fee)_
      * Повышение баланса при закрытии таски юзером _(account_public_id, task.amount)_
      * Перенос отрицательного баланса на след день _(account_public_id, account.balance)_
      * Обнуление положительного баланса в конце дня _(account_public_id, account.balance)_
      * Генерация таксы и оплаты за таску при создании таски _(task_public_id, task.fee, task.amount)_
  * Синхронные:
    * BE-события:
      * Запрос аутентификации в **Auth service** _(account.email, account.password)_
      * отправка писем юзерам (в бэкграунде)
* Consuming:
  * Асинхронные:
    * из **Auth service:**
      * CUD-события:
        * создание юзера
        * редактирование юзера
        * удаление юзера
      * BE-события:
        * смена роли юзера
    * из **Tracker service:**
      * CUD-события:
        * создание таски
        * редактирование таски
        * удаление таски
      * BE-события:
        * назначение таски
        * смена статуса таски (закрытие)

## Analytics
* Producing:
  * Синхронные:
    * Запрос аутентификации в **Auth service** _(account.email, account.password)_
* Consuming:
  * Асинхронные:
    * из **Auth service:**
      * CUD-события:
        * создание юзера
        * редактирование юзера
        * удаление юзера
      * BE-события:
        * смена роли юзера
    * из **Tracker service:**
      * CUD-события:
        * создание таски
        * редактирование таски
        * удаление таски
      * BE-события:
        * назначение таски
        * смена статуса таски (закрытие)
    * из **Accounting service:**
      * BE-события:
        * Снижение баланса при назначении таски юзеру
        * Повышение баланса при закрытии таски юзером
        * Перенос отрицательного баланса на след день
        * Обнуление положительного баланса в конце дня
        * Генерация таксы и оплаты за таску при создании таски
